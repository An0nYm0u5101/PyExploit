''' This file is part of PyExploit '''

from time import sleep
from googlesearch import search, get_random_user_agent

# Third party for error handling
from urllib.error import URLError
from socket import gaierror

def gdork(domain):
    ''' Run google dorks against domain '''
    try:
        dorks = {
                'Login portal':[
                    f'site:{domain} intext:login',
                    ],
                'Files':[f'site:{domain} filetype:pdf'],
            }
        result = ''

        for dork_type in dorks.keys():
            user_agent = get_random_user_agent()
            result += f'=================\n{dork_type.upper()}\n=================\n'
            for dork in dorks[dork_type]:
                data = search(dork, user_agent=user_agent)
                for link in data:
                    print(link)
                    result += (link +"\n")
                result += '\n'

        return result
    except (gaierror, URLError):
        return 0
