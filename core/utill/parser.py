''' This File is part of PyExploit '''

import re
from json import loads

def shodan_parser(content):
    '''Shodan api parser'''
    try:
        text = f"Total: {content['total']}\n\n\n"
        for host in content['matches']:
            text += f"Organization: {host['org']}\n"
            text += f"IP: {host['ip_str']}\n"
            text += f"Hostnames: {', '.join(host['domains'])}\n"
            text += f"OS: {host['os']}\n"
            text += f"Port: {host['port']}\n\n"

        yield text
    except TypeError:
        return 0

def pwned_parser(content):
    ''' PWNED api parser '''
    try:
        data = loads(content)
        text = "PWNED\n\n\n"
        for key in data[0]:
            text += f"{key} : {data[0][key]}\n"
        return text
    except IndexError:
        return 9
    except TypeError:
        return 0
