''' This file is part of PyExploit '''

from sys import exit as exits
from core.utill.parser import shodan_parser, pwned_parser
from core.style import (success, error, menu, CHOOSE, GDOMAIN)

from modules.recon.passive.hackertarget import hackertarget
from modules.recon.passive.shodan import Shodan
from modules.recon.passive.whois import whois
from modules.recon.passive.geoip import geoip
from modules.recon.passive.pwned import pwned

def load(module, arg):
    ''' Module loader '''
    return module(arg)

def domain(module):
    ''' bla bla bla read the code and uou will understand '''
    domain = str(input(GDOMAIN))
    data = load(module, domain)
    if data != 0:
        return data
    else:
        error("Something went worng")
    exits()

def manual():
    ''' manual interface '''
    menu(["Whois", "GEO to IP", "Shodan", "Subdoamins", "PWNED ?"])
    try:
        choose = int(input(CHOOSE))
        if choose == 1:
            domain(whois)
            exits()
        if choose == 2:
            domain(geoip)
            exits()
        if choose == 3:
            for item in shodan_parser(domain(Shodan)):
                print(item)
                exits()
        if choose == 4:
            domain(hackertarget)
            exits()
        if choose == 5:
            pwn = pwned_parser(domain(pwned))
            if pwn != 0:
                success(pwn)
            if pwn == 9:
                error("Not Found")
            else:
                error("Something went wrong")
            exits()
        else:
            error("Wrong number")
            exits()
    except ValueError:
        error("Please only nembers")
        exits()
